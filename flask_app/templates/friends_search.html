<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Find A Friend</title>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/menu.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/search.css') }}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">
</head>
<body>
    <!-- main wrapper -->
    <main>
        <!-- logo bar -->
        <div>
            <img class="logo" src="https://live.staticflickr.com/65535/52792585959_75b5df6be8_h.jpg" alt="getOUTSIDE">
        </div>
        <!-- hamburger nav -->
        <div class="hamburger-menu">
            <input id="menu__toggle" type="checkbox" />
            <label class="menu__btn" for="menu__toggle">
                <span></span>
            </label>
            <ul class="menu__box">
                <li><a class="menu__item" href="/getoutside/myprofile">My Profile</a></li>
                <li><a class="menu__item" href="/getoutside/activities">Activities</a></li>
                <li><a class="menu__item" href="/logout">Log Out</a></li>
            </ul>
        </div>
        <!-- end hamburger nav -->
        <!-- INPUT SECTION -->
        <h1>Find friends to Get Outside!</h1>
        <div class="formContainer">
            <div class="filter-post" >
                <input type="text" class="filter" id="filter" placeholder="Type Name..." onkeyup="searchUser()" />
            </div>
        </div>
        <!-- END INPUT SECTION -->
        <!-- Display Users -->
        <table class="display_table" id="userTable">
            <thead>
                <tr>
                    <th>Name</th>
                    <th></th>
                </tr>
            </thead>
            <tbody id="filtered_list">
                {% for user in allusers %}
                <!-- declare counter -->
                {% set ns = namespace(counter =0) %}
                <tr>
                    <!-- loop to see if array contains match -->
                    {% for follow in followers%}
                        {% if user.id == follow.friend.id %}
                            <!-- increase counter when match found -->
                            {% set ns.counter = ns.counter +1 %}
                        {% endif%}
                    {% endfor %}
                    <!-- display based on matches found -->
                    <!-- no matches -->
                    {% if ns.counter == 0 %}
                        <td><a href="/getoutside/athlete/{{user.id}}">{{user.first_name.capitalize()}} {{user.last_name.capitalize()}} </a></td>
                        <td>{{ ns.counter }}<a class="btn btn-success m-1 p-1 rounded-2 border-2 border-dark text-decoration-none text-light"  href="/getoutside/athlete/{{user.id}}/follow"  role="button">FOLLOW</a></td>
                    <!-- matches -->
                    {% else %}
                        <td><a href="/getoutside/athlete/{{user.id}}">{{user.first_name.capitalize()}} {{user.last_name.capitalize()}} </a></td>
                        <td>{{ ns.counter }}<a class="btn btn-success m-1 p-1 rounded-2 border-2 border-dark text-decoration-none text-light"  href="/getoutside/athlete/{{user.id}}/unfollow"  role="button">UNFOLLOW</a></td>
                    {% endif%}
                {% endfor %}
                </tr>
            </tbody>
        </table>
        <!-- END Display Users -->
    </main>
</body>
<script src="{{ url_for('static', filename='js/search_script.js') }}"></script>
<script src="{{ url_for('static', filename='js/script.js') }}"></script>
</html>